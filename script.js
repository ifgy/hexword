const beeSelector=document.querySelector(".bee"),totalIntSelector=document.querySelector(".totalInt"),resetSelector=document.querySelector("button"),bar=document.querySelector(".barContainer"),levelBar=document.querySelector(".levelBar"),beesList=["images/belle.png","images/content.png","images/dodo.png","images/enerve.png","images/non.png","images/travail.png","images/vieux.png"];let beesTab=[],shimmersTab=[],couleurs=["#ffffff","#a7dada","#84b7b7","d3ffff"],n=0;function append_bee(){let e=Math.floor(100*Math.random());beesTab.push({x:e,y:100,vy:2,image:beesList[Math.floor(7*Math.random())]}),d3.select("svg").select(".bees").selectAll(".newBee").data(beesTab).enter().append("image").attr("xlink:href",e=>`${e.image}`).attr("x",e=>`${e.x}`).attr("y",e=>`${e.y}`).attr("vy",e=>`${e.vy}`).attr("class","newBee")}function append_circle(){let e=0;for(;e<=100;){let t=100+Math.floor(50*Math.random()),r=1+Math.floor(4*Math.random()),a=Math.floor(2*Math.random()),l=Math.floor(3*Math.random());shimmersTab.push({x:Math.floor(100*Math.random()),y:t,r:a,vy:r,couleur:couleurs[l]}),e++}d3.select("svg").select(".shimmer").selectAll(".shimmers").data(shimmersTab).enter().append("circle").attr("cx",e=>`${e.x}`).attr("cy",e=>`${e.y}`).attr("r",e=>`${e.r}`).attr("vy",e=>`${e.vy}`).attr("fill",e=>`${e.couleurs}`).attr("class","shimmers")}function fly(){d3.selectAll(".newBee").data(beesTab),beesTab.forEach(e=>{e.y-=e.vy}),d3.selectAll(".newBee").data(beesTab).attr("xlink:href",e=>`${e.image}`).attr("x",e=>`${e.x}`).attr("y",e=>`${e.y}`),suppressionDansTableau(beesTab,e=>e.y<-15)&&suppressionBee()}function shimmering(){d3.selectAll(".shimmers").data(shimmersTab),shimmersTab.forEach(e=>{e.y-=e.vy}),d3.select(".shimmer").selectAll(".shimmers").data(shimmersTab).attr("cx",e=>`${e.x}`).attr("r",e=>`${e.r}`).attr("fill",e=>`${e.couleur}`).attr("cy",e=>`${e.y}`),suppressionDansTableau(shimmersTab,e=>e.y<-15)&&suppressionCircle()}function suppressionDansTableau(e,t){let r=!1;for(let a=e.length-1;a>=0;a--)t(e[a])&&(e.splice(a,1),r=!0);return r}function suppressionBee(){let e=d3.select("svg").selectAll(".newBee").data(beesTab);e.enter().append("use").attr("class","newBee").attr("href","#def_bee"),e.exit().remove(),fly()}function suppressionCircle(){let e=d3.select("svg").selectAll(".shimmers").data(shimmersTab);e.enter().append("use").attr("class","shimmers").attr("href","#def_circle"),e.exit().remove(),shimmering()}d3.select(".bee").attr("x","20%").attr("y","20%"),countBees=(()=>{let e=parseInt(totalIntSelector.innerHTML)+1;totalIntSelector.innerHTML=e,levelCount(),document.querySelector(".click").parentNode.removeChild(document.querySelector(".click"))}),levelCount=(()=>{let e;e=bar.clientWidth<=400?.031:.021;let t=bar.clientWidth*e,r=Math.floor(100*(levelBar.clientWidth+t)/bar.clientWidth);r>=100?(levelBar.style.width="0%",append_circle()):levelBar.style.width=r+"%"}),resetCount=(()=>{totalIntSelector.innerHTML="0",levelBar.style.width="0%",document.querySelector(".bees").innerHTML=""}),resetSelector.addEventListener("click",resetCount),beeSelector.addEventListener("click",countBees),d3.select(".bee").on("click",append_bee),setInterval(fly,50),setInterval(shimmering,50);